<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××‘×—×Ÿ ×’×œ×™×©×” ×‘×˜×•×—×” ×‘×¨×©×ª</title>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;600;700;800&family=Assistant:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --primary-dark: #1e40af;
            --secondary: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --bg-main: #0f172a;
            --bg-card: #1e293b;
            --bg-card-hover: #334155;
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --border: #334155;
            --shadow: rgba(0, 0, 0, 0.3);
        }

        body {
            font-family: 'Assistant', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(37, 99, 235, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(16, 185, 129, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            animation: fadeInDown 0.8s ease-out;
        }

        .header h1 {
            font-family: 'Rubik', sans-serif;
            font-size: 3.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, #60a5fa 0%, #34d399 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            text-shadow: 0 0 30px rgba(96, 165, 250, 0.3);
        }

        .header p {
            font-size: 1.2rem;
            color: var(--text-secondary);
            font-weight: 400;
        }

        .card {
            background: var(--bg-card);
            border-radius: 24px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 20px 60px var(--shadow);
            border: 1px solid var(--border);
            transition: all 0.3s ease;
            animation: fadeInUp 0.8s ease-out;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.4);
            border-color: var(--primary);
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--text-primary);
        }

        .form-group input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--bg-main);
            color: var(--text-primary);
            font-size: 1rem;
            font-family: 'Assistant', sans-serif;
            transition: all 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.1);
        }

        .question-card {
            margin-bottom: 30px;
            animation: fadeInUp 0.6s ease-out;
        }

        .question-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .question-number {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.3rem;
            box-shadow: 0 10px 25px rgba(37, 99, 235, 0.3);
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 600;
            flex: 1;
            line-height: 1.6;
        }

        .answers {
            display: grid;
            gap: 15px;
            margin-top: 20px;
        }

        .answer-option {
            position: relative;
        }

        .answer-option input[type="radio"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
        }

        .answer-label {
            display: flex;
            align-items: center;
            padding: 18px 24px;
            background: var(--bg-main);
            border: 2px solid var(--border);
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.05rem;
            line-height: 1.6;
        }

        .answer-label:hover {
            background: var(--bg-card-hover);
            border-color: var(--primary);
            transform: translateX(-5px);
        }

        .answer-option input[type="radio"]:checked + .answer-label {
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.2) 0%, rgba(37, 99, 235, 0.1) 100%);
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.1);
        }

        .answer-label::before {
            content: '';
            width: 24px;
            height: 24px;
            border: 2px solid var(--border);
            border-radius: 50%;
            margin-left: 15px;
            flex-shrink: 0;
            transition: all 0.3s ease;
            background: var(--bg-card);
        }

        .answer-option input[type="radio"]:checked + .answer-label::before {
            background: var(--primary);
            border-color: var(--primary);
            box-shadow: inset 0 0 0 4px var(--bg-card);
        }

        .btn {
            padding: 18px 40px;
            font-size: 1.2rem;
            font-weight: 700;
            border: none;
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Rubik', sans-serif;
            box-shadow: 0 10px 30px var(--shadow);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(37, 99, 235, 0.4);
        }

        .btn-primary:active {
            transform: translateY(-1px);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-block {
            width: 100%;
        }

        .results-card {
            text-align: center;
        }

        .score-display {
            font-size: 5rem;
            font-weight: 800;
            margin: 30px 0;
            background: linear-gradient(135deg, #60a5fa 0%, #34d399 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: scaleIn 0.6s ease-out;
        }

        .results-details {
            margin-top: 40px;
            text-align: right;
        }

        .result-item {
            background: var(--bg-main);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            border-right: 4px solid var(--border);
            animation: fadeInRight 0.5s ease-out;
        }

        .result-item.correct {
            border-right-color: var(--secondary);
            background: linear-gradient(90deg, rgba(16, 185, 129, 0.1) 0%, var(--bg-main) 100%);
        }

        .result-item.incorrect {
            border-right-color: var(--danger);
            background: linear-gradient(90deg, rgba(239, 68, 68, 0.1) 0%, var(--bg-main) 100%);
        }

        .result-question {
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        .result-answer {
            margin: 8px 0;
            padding: 10px;
            border-radius: 8px;
            font-size: 1rem;
        }

        .your-answer {
            background: rgba(37, 99, 235, 0.1);
            color: var(--text-secondary);
        }

        .correct-answer {
            background: rgba(16, 185, 129, 0.1);
            color: var(--secondary);
            font-weight: 600;
        }

        .explanation {
            margin-top: 12px;
            padding: 15px;
            background: rgba(245, 158, 11, 0.1);
            border-radius: 8px;
            color: var(--text-secondary);
            border-right: 3px solid var(--warning);
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .hidden {
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--bg-main);
            border-radius: 10px;
            margin-bottom: 30px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary) 0%, var(--secondary) 100%);
            transition: width 0.5s ease;
            border-radius: 10px;
        }

        .download-btn {
            margin-top: 30px;
            background: linear-gradient(135deg, var(--secondary) 0%, #059669 100%);
            color: white;
        }

        .download-btn:hover {
            box-shadow: 0 15px 40px rgba(16, 185, 129, 0.4);
        }

        .status-message {
            margin-top: 20px;
            padding: 15px 20px;
            border-radius: 12px;
            font-size: 1rem;
            text-align: center;
            animation: fadeInUp 0.5s ease-out;
        }

        .status-message.success {
            background: rgba(16, 185, 129, 0.2);
            border: 2px solid var(--secondary);
            color: var(--secondary);
        }

        .status-message.error {
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid var(--danger);
            color: #fca5a5;
        }

        .status-message.info {
            background: rgba(37, 99, 235, 0.2);
            border: 2px solid var(--primary);
            color: #93c5fd;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.5);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .emoji {
            font-size: 4rem;
            margin: 20px 0;
            animation: scaleIn 0.6s ease-out 0.3s both;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5rem;
            }

            .card {
                padding: 25px;
            }

            .score-display {
                font-size: 3.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” ××‘×—×Ÿ ×’×œ×™×©×” ×‘×˜×•×—×”</h1>
            <p>×‘×“×•×§ ××ª ×”×™×“×¢ ×©×œ×š ×‘× ×•×©× ××‘×˜×—×ª ××™×“×¢ ×•×’×œ×™×©×” ×‘×˜×•×—×” ×‘×¨×©×ª</p>
        </div>

        <!-- Student Info Form -->
        <div id="studentForm" class="card">
            <h2 style="margin-bottom: 30px; font-size: 2rem; font-weight: 700;">×¤×¨×˜×™ ×”×ª×œ××™×“</h2>
            <div class="form-group">
                <label for="firstName">×©× ×¤×¨×˜×™:</label>
                <input type="text" id="firstName" required placeholder="×”×›× ×¡ ×©× ×¤×¨×˜×™">
            </div>
            <div class="form-group">
                <label for="lastName">×©× ××©×¤×—×”:</label>
                <input type="text" id="lastName" required placeholder="×”×›× ×¡ ×©× ××©×¤×—×”">
            </div>
            <div class="form-group">
                <label for="className">×›×™×ª×”:</label>
                <input type="text" id="className" required placeholder="×œ×“×•×’××”: ×˜'5">
            </div>
            <button class="btn btn-primary btn-block" onclick="startQuiz()">×”×ª×—×œ ××‘×—×Ÿ</button>
        </div>

        <!-- Quiz Section -->
        <div id="quizSection" class="hidden">
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar" style="width: 0%"></div>
            </div>
            <div id="questionsContainer"></div>
            <button class="btn btn-primary btn-block" id="submitBtn" onclick="submitQuiz()">×¡×™×™× ××‘×—×Ÿ</button>
        </div>

        <!-- Results Section -->
        <div id="resultsSection" class="hidden">
            <div class="card results-card">
                <h2 style="font-size: 2.5rem; margin-bottom: 20px;">×ª×•×¦××•×ª ×”××‘×—×Ÿ</h2>
                <div class="emoji" id="resultEmoji"></div>
                <div class="score-display" id="scoreDisplay"></div>
                <p id="scoreFeedback" style="font-size: 1.3rem; color: var(--text-secondary);"></p>
                <div id="statusMessage"></div>
                <button class="btn download-btn btn-block" onclick="downloadExcel()">ğŸ’¾ ×”×•×¨×“ ×ª×•×¦××•×ª ×œ××§×¡×œ</button>
            </div>
            <div class="card">
                <h3 style="font-size: 2rem; margin-bottom: 30px; text-align: center;">×¡×™×›×•× ××¤×•×¨×˜</h3>
                <div id="resultsDetails" class="results-details"></div>
            </div>
        </div>
    </div>

    <script>
        // ×›×ª×•×‘×ª ×”-API ×©×œ Google Apps Script
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwaH5L-HqgbgjSOgHBvtkxOp7Dl10Ejr2ztaeHMh81c9x5_N7t08F4jHSGsdYdby-AV/exec';

        const questions = [
            {
                question: "××”×• ×”×¡×™×¡××” ×”×—×–×§×” ×‘×™×•×ª×¨?",
                answers: [
                    "123456",
                    "MyName2024",
                    "K9#mL$pQ2@vN8!wR",
                    "Password123"
                ],
                correct: 2,
                explanation: "×¡×™×¡××” ×—×–×§×” ×¦×¨×™×›×” ×œ×”×›×™×œ ×œ×¤×—×•×ª 12 ×ª×•×•×™×, ×©×™×œ×•×‘ ×©×œ ××•×ª×™×•×ª ×’×“×•×œ×•×ª ×•×§×˜× ×•×ª, ××¡×¤×¨×™× ×•×ª×•×•×™× ××™×•×—×“×™×. ×”×¡×™×¡××” 'K9#mL$pQ2@vN8!wR' ×”×™× ×”×‘×˜×•×—×” ×‘×™×•×ª×¨."
            },
            {
                question: "×§×™×‘×œ×ª ××™××™×™×œ ××”×‘× ×§ ×©××‘×§×© ×××š ×œ×”×–×™×Ÿ ××ª ×¤×¨×˜×™ ×›×¨×˜×™×¡ ×”××©×¨××™. ××” ×›×“××™ ×œ×¢×©×•×ª?",
                answers: [
                    "×œ××œ× ××ª ×”×¤×¨×˜×™× ××™×“ ×›×™ ×–×” ×“×—×•×£",
                    "×œ×©×œ×•×— ××ª ×”×¤×¨×˜×™× ×¨×§ ×× ×”××™×™×œ × ×¨××” ×¨×©××™",
                    "×œ× ×œ××œ×! ×‘× ×§×™× ××£ ×¤×¢× ×œ× ××‘×§×©×™× ××™×“×¢ ×¨×’×™×© ×‘××™××™×™×œ ×•×œ×”×ª×§×©×¨ ×œ×‘× ×§",
                    "×œ×©×ª×£ ××ª ×”××™×™×œ ×¢× ×—×‘×¨×™× ×›×“×™ ×œ×©××•×¢ ×“×¢×”"
                ],
                correct: 2,
                explanation: "×–×”×• × ×™×¡×™×•×Ÿ ×¤×™×©×™× ×’! ×‘× ×§×™× ×•××•×¡×“×•×ª ×¤×™× × ×¡×™×™× ×œ×¢×•×œ× ×œ× ×™×‘×§×©×• ××™×“×¢ ×¨×’×™×© ×‘××™××™×™×œ. ×™×© ×œ×”×ª×§×©×¨ ×œ×‘× ×§ ×“×¨×š ×”××¡×¤×¨ ×”×¨×©××™ ×•×œ×•×•×“×."
            },
            {
                question: "××” ×–×” '×¤×™×©×™× ×’' (Phishing)?",
                answers: [
                    "××©×—×§ ××—×©×‘ ×¤×•×¤×•×œ×¨×™",
                    "×ª×•×›× ×” ×œ×”×’× ×” ××¤× ×™ ×•×™×¨×•×¡×™×",
                    "× ×™×¡×™×•×Ÿ ×œ×”×•× ××” ×‘×××¦×¢×•×ª ×”×¡×ª××›×•×ª ×¢×œ ××¨××” ×©×œ ×’×•×£ ××•×›×¨ ×›×“×™ ×œ×’× ×•×‘ ××™×“×¢ ××™×©×™",
                    "×ª×•×›× ×” ×œ×—×™×¤×•×© ×§×‘×¦×™× ×‘××—×©×‘"
                ],
                correct: 2,
                explanation: "×¤×™×©×™× ×’ ×”×•× ××ª×§×¤×ª ×¡×™×™×‘×¨ ×©×‘×” ×ª×•×§×¤×™× ××ª×—×–×™× ×œ×’×•×¨× ××•×›×¨ (×‘× ×§, ×—×‘×¨×”) ×›×“×™ ×œ×’× ×•×‘ ××™×“×¢ ××™×©×™, ×¡×™×¡×××•×ª ××• ×¤×¨×˜×™ ××©×¨××™."
            },
            {
                question: "××™×–×” ×¡×•×’ ×§×‘×¦×™× ××¡×•×›×Ÿ ×œ×”×•×¨×™×“ ××”××™× ×˜×¨× ×˜?",
                answers: [
                    "×¨×§ ×§×‘×¦×™ .jpg (×ª××•× ×•×ª)",
                    "×§×‘×¦×™ .exe, .zip, .rar ×××§×•×¨×•×ª ×œ× ××•×›×¨×™×",
                    "×§×‘×¦×™ .mp3 (××•×–×™×§×”)",
                    "×§×‘×¦×™ .txt (××¡××›×™ ×˜×§×¡×˜)"
                ],
                correct: 1,
                explanation: "×§×‘×¦×™ ×”×¤×¢×œ×” (.exe) ×•××¨×›×™×•× ×™× (.zip, .rar) ×××§×•×¨×•×ª ×œ× ××•×›×¨×™× ×¢×œ×•×œ×™× ×œ×”×›×™×œ ×ª×•×›× ×•×ª ×–×“×•× ×™×•×ª. ×™×© ×œ×”×•×¨×™×“ ×§×‘×¦×™× ×¨×§ ×××§×•×¨×•×ª ×××™× ×™×."
            },
            {
                question: "××” ×–×” ××™××•×ª ×“×•-×©×œ×‘×™ (Two-Factor Authentication)?",
                answers: [
                    "×©×™××•×© ×‘×©×ª×™ ×¡×™×¡×××•×ª ×©×•× ×•×ª",
                    "×©×›×‘×ª ××‘×˜×—×” × ×•×¡×¤×ª ×©×“×•×¨×©×ª ×§×•×“ ××• ××™×©×•×¨ × ×•×¡×£ ××œ×‘×“ ×”×¡×™×¡××”",
                    "×›× ×™×¡×” ×œ×—×©×‘×•×Ÿ ×¤×¢××™×™× ×‘×™×•×",
                    "×©×™×ª×•×£ ×”×¡×™×¡××” ×¢× ×©× ×™ ×× ×©×™×"
                ],
                correct: 1,
                explanation: "××™××•×ª ×“×•-×©×œ×‘×™ ××•×¡×™×£ ×©×›×‘×ª ×”×’× ×” × ×•×¡×¤×ª - ××œ×‘×“ ×”×¡×™×¡××”, × ×“×¨×© ×§×•×“ ×©× ×©×œ×— ×œ×˜×œ×¤×•×Ÿ ××• ××™×©×•×¨ ×‘××¤×œ×™×§×¦×™×”, ××” ×©××§×©×” ×¢×œ ×”××§×¨×™× ×œ×”×™×›× ×¡ ×œ×—×©×‘×•×Ÿ."
            },
            {
                question: "×”×× ×‘×˜×•×— ×œ×”×ª×—×‘×¨ ×œ×¨×©×ª WiFi ×¦×™×‘×•×¨×™×ª ×‘××§×•××•×ª ×›××• ×‘×ª×™ ×§×¤×”?",
                answers: [
                    "×›×Ÿ, ×–×” ×ª××™×“ ×‘×˜×•×— ×œ×—×œ×•×˜×™×Ÿ",
                    "×›×Ÿ, ×× ×”×¨×©×ª ××•×’× ×ª ×‘×¡×™×¡××”",
                    "×œ× ×‘×˜×•×— - ×¨×©×ª×•×ª ×¦×™×‘×•×¨×™×•×ª ×××¤×©×¨×•×ª ×’×™×©×” ×œ××™×“×¢ ×©×œ×š, ×›×“××™ ×œ×”×©×ª××© ×‘-VPN",
                    "×–×” ×‘×˜×•×— ×¨×§ ×‘×™××™ ×©×™×©×™"
                ],
                correct: 2,
                explanation: "×¨×©×ª×•×ª WiFi ×¦×™×‘×•×¨×™×•×ª ××™× ×Ÿ ×××•×‘×˜×—×•×ª ×•×ª×•×§×¤×™× ×™×›×•×œ×™× ×œ×™×™×¨×˜ ××™×“×¢. ××•××œ×¥ ×œ×”×©×ª××© ×‘-VPN ××• ×œ×”×™×× ×¢ ××¤×¢×™×œ×•×™×•×ª ×¨×’×™×©×•×ª ×‘×¨×©×ª×•×ª ××œ×”."
            },
            {
                question: "××” ×›×“××™ ×œ×¢×©×•×ª ×¢× ×¢×“×›×•× ×™ ×ª×•×›× ×” ×©×”××¢×¨×›×ª ××‘×§×©×ª ×œ×”×ª×§×™×Ÿ?",
                answers: [
                    "×œ×”×ª×¢×œ× ××”× ×›×™ ×”× ××¢×¦×‘× ×™×",
                    "×œ×”×ª×§×™×Ÿ ×¨×§ ×¤×¢× ×‘×©× ×”",
                    "×œ×”×ª×§×™×Ÿ ××™×“ - ×¢×“×›×•× ×™× ××›×™×œ×™× ×ª×™×§×•× ×™ ××‘×˜×—×” ×—×©×•×‘×™×",
                    "×œ×‘×§×© ××—×‘×¨ ×œ×”×ª×§×™×Ÿ ×‘×©×‘×™×œ×™"
                ],
                correct: 2,
                explanation: "×¢×“×›×•× ×™ ×ª×•×›× ×” ×—×©×•×‘×™× ×××•×“! ×”× ××›×™×œ×™× ×ª×™×§×•× ×™ ××‘×˜×—×” ×©×¡×•×’×¨×™× ×¤×¨×¦×•×ª ××‘×˜×—×” ×©×”××§×¨×™× ×¢×œ×•×œ×™× ×œ× ×¦×œ. ×™×© ×œ×”×ª×§×™×Ÿ ×¢×“×›×•× ×™× ×›×©×”× ×–××™× ×™×."
            },
            {
                question: "××™×©×”×• ×©××ª×” ×œ× ××›×™×¨ ×‘×™×§×© ×××š ×œ×”×•×¡×™×£ ××•×ª×• ×›×—×‘×¨ ×‘×¨×©×ª ×—×‘×¨×ª×™×ª ×•×©×œ×— ×§×™×©×•×¨. ××” ×ª×¢×©×”?",
                answers: [
                    "××œ×—×¥ ×¢×œ ×”×§×™×©×•×¨ ××™×“ ×›×™ ×× ×™ ×¡×§×¨×Ÿ",
                    "××©×ª×£ ××ª ×”×§×™×©×•×¨ ×¢× ×›×•×œ×",
                    "×œ× ××œ×—×¥ ×•××—×¡×•× - ×–×” ×™×›×•×œ ×œ×”×™×•×ª × ×™×¡×™×•×Ÿ ×”×ª×§×¤×” ××• ×’× ×™×‘×ª ××™×“×¢",
                    "××›× ×¡ ×œ×§×™×©×•×¨ ×¨×§ ×× ×™×© ×ª××•× ×ª ×¤×¨×•×¤×™×œ ×™×¤×”"
                ],
                correct: 2,
                explanation: "×× ×©×™× ×œ× ××•×›×¨×™× ×‘×¨×©×ª×•×ª ×—×‘×¨×ª×™×•×ª ×¢×œ×•×œ×™× ×œ×”×™×•×ª ×‘×•×˜×™× ××• ×ª×•×§×¤×™×. ××œ ×ª×œ×—×¥ ×¢×œ ×§×™×©×•×¨×™× ××–×¨×™× ×•××œ ×ª×§×‘×œ ×‘×§×©×•×ª ×—×‘×¨×•×ª ×××™ ×©××™× ×š ××›×™×¨."
            },
            {
                question: "××”×™ ×“×¨×š ×‘×˜×•×—×” ×œ×©××•×¨ ×¡×™×¡×××•×ª?",
                answers: [
                    "×œ×›×ª×•×‘ ××•×ª×Ÿ ×¢×œ ×¤×ª×§ ×œ×™×“ ×”××—×©×‘",
                    "×œ×©×ª×£ ××•×ª×Ÿ ×¢× ×—×‘×¨×™× ×œ××§×¨×” ×©×©×›×—×ª×™",
                    "×œ×”×©×ª××© ×‘×× ×”×œ ×¡×™×¡×××•×ª (Password Manager) ×××•×‘×˜×—",
                    "×œ×”×©×ª××© ×‘××•×ª×” ×¡×™×¡××” ×œ×›×œ ×”××ª×¨×™× ×›×“×™ ×œ× ×œ×©×›×•×—"
                ],
                correct: 2,
                explanation: "×× ×”×œ ×¡×™×¡×××•×ª ×”×•× ×”×“×¨×š ×”×‘×˜×•×—×” ×‘×™×•×ª×¨ - ×”×•× ×××—×¡×Ÿ ×¡×™×¡×××•×ª ×‘×¦×•×¨×” ××•×¦×¤× ×ª ×•×××¤×©×¨ ×©×™××•×© ×‘×¡×™×¡×××•×ª ×©×•× ×•×ª ×•×—×–×§×•×ª ×œ×›×œ ××ª×¨."
            },
            {
                question: "××” ×–×• ×”× ×“×¡×” ×—×‘×¨×ª×™×ª (Social Engineering)?",
                answers: [
                    "×‘× ×™×™×ª ×’×©×¨×™× ×•×‘× ×™×™× ×™×",
                    "×˜×›× ×™×§×ª ×× ×™×¤×•×œ×¦×™×” ×¤×¡×™×›×•×œ×•×’×™×ª ×œ×’×¨×•× ×œ×× ×©×™× ×œ×—×©×•×£ ××™×“×¢ ×¡×•×“×™",
                    "×ª×›× ×•×ª ××ª×¨×™ ××™× ×˜×¨× ×˜",
                    "× ×™×”×•×œ ×§×‘×•×¦×•×ª ×‘×¤×™×™×¡×‘×•×§"
                ],
                correct: 1,
                explanation: "×”× ×“×¡×” ×—×‘×¨×ª×™×ª ×”×™× ×˜×›× ×™×§×” ×©×‘×” ×ª×•×§×¤×™× ××©×ª××©×™× ×‘×× ×™×¤×•×œ×¦×™×” ×¤×¡×™×›×•×œ×•×’×™×ª ×•×‘××”× ×“×¡×•×ª ×××•×Ÿ ×›×“×™ ×œ×’×¨×•× ×œ×× ×©×™× ×œ×—×©×•×£ ××™×“×¢ ×¡×•×“×™ ××• ×œ×‘×¦×¢ ×¤×¢×•×œ×•×ª ××¡×•×›× ×•×ª."
            }
        ];

        let studentData = {};
        let userAnswers = [];
        let startTime;

        function startQuiz() {
            const firstName = document.getElementById('firstName').value.trim();
            const lastName = document.getElementById('lastName').value.trim();
            const className = document.getElementById('className').value.trim();

            if (!firstName || !lastName || !className) {
                alert('×× × ××œ× ××ª ×›×œ ×”×©×“×•×ª');
                return;
            }

            studentData = {
                firstName,
                lastName,
                className,
                date: new Date().toLocaleDateString('he-IL'),
                time: new Date().toLocaleTimeString('he-IL')
            };

            document.getElementById('studentForm').classList.add('hidden');
            document.getElementById('quizSection').classList.remove('hidden');
            
            renderQuestions();
            startTime = new Date();
            updateProgress();
        }

        function renderQuestions() {
            const container = document.getElementById('questionsContainer');
            container.innerHTML = '';

            questions.forEach((q, index) => {
                const questionCard = document.createElement('div');
                questionCard.className = 'card question-card';
                questionCard.style.animationDelay = `${index * 0.1}s`;
                
                questionCard.innerHTML = `
                    <div class="question-header">
                        <div class="question-number">${index + 1}</div>
                        <div class="question-text">${q.question}</div>
                    </div>
                    <div class="answers">
                        ${q.answers.map((answer, i) => `
                            <div class="answer-option">
                                <input type="radio" name="q${index}" id="q${index}_a${i}" value="${i}" onchange="updateProgress()">
                                <label class="answer-label" for="q${index}_a${i}">
                                    ${answer}
                                </label>
                            </div>
                        `).join('')}
                    </div>
                `;
                
                container.appendChild(questionCard);
            });
        }

        function updateProgress() {
            const answered = questions.filter((_, i) => 
                document.querySelector(`input[name="q${i}"]:checked`)
            ).length;
            const progress = (answered / questions.length) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
        }

        async function submitQuiz() {
            userAnswers = [];
            let allAnswered = true;

            questions.forEach((q, index) => {
                const selected = document.querySelector(`input[name="q${index}"]:checked`);
                if (!selected) {
                    allAnswered = false;
                } else {
                    userAnswers.push(parseInt(selected.value));
                }
            });

            if (!allAnswered) {
                alert('×× × ×¢× ×” ×¢×œ ×›×œ ×”×©××œ×•×ª ×œ×¤× ×™ ×”×’×©×ª ×”××‘×—×Ÿ');
                return;
            }

            // ×—×™×©×•×‘ ×¦×™×•×Ÿ
            let correctCount = 0;
            questions.forEach((q, index) => {
                if (userAnswers[index] === q.correct) correctCount++;
            });
            const score = Math.round((correctCount / questions.length) * 100);

            studentData.score = score;
            studentData.correctCount = correctCount;
            studentData.totalQuestions = questions.length;
            studentData.answers = userAnswers;

            // ×”×¦×’×ª ×ª×•×¦××•×ª
            showResults();

            // ×©××™×¨×” ×œ-Google Sheets
            await saveToGoogleSheets();
        }

        async function saveToGoogleSheets() {
            const statusDiv = document.getElementById('statusMessage');
            const submitBtn = document.getElementById('submitBtn');
            
            statusDiv.innerHTML = '<div class="status-message info">â³ ×©×•××¨ ×ª×•×¦××•×ª ×œ-Google Sheets...</div>';
            submitBtn.disabled = true;

            try {
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(studentData)
                });

                // ×‘×’×œ×œ no-cors, ×œ× × ×•×›×œ ×œ×§×¨×•× ××ª ×”×ª×©×•×‘×”, ××‘×œ ×× ×”×’×¢× ×• ×œ×›××Ÿ ×–×” ××•××¨ ×©×”×‘×§×©×” × ×©×œ×—×”
                statusDiv.innerHTML = '<div class="status-message success">âœ… ×”×ª×•×¦××•×ª × ×©××¨×• ×‘×”×¦×œ×—×” ×‘-Google Sheets!</div>';
                
            } catch (error) {
                console.error('Error saving to Google Sheets:', error);
                statusDiv.innerHTML = '<div class="status-message error">âŒ ×©×’×™××” ×‘×©××™×¨×”. ×× × ×”×•×¨×“ ××ª ×§×•×‘×¥ ×”××§×¡×œ.</div>';
            } finally {
                submitBtn.disabled = false;
            }
        }

        function showResults() {
            document.getElementById('quizSection').classList.add('hidden');
            document.getElementById('resultsSection').classList.remove('hidden');

            const resultsHTML = [];

            questions.forEach((q, index) => {
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer === q.correct;

                resultsHTML.push(`
                    <div class="result-item ${isCorrect ? 'correct' : 'incorrect'}">
                        <div class="result-question">
                            ${isCorrect ? 'âœ…' : 'âŒ'} ×©××œ×” ${index + 1}: ${q.question}
                        </div>
                        <div class="result-answer your-answer">
                            ×”×ª×©×•×‘×” ×©×œ×š: ${q.answers[userAnswer]}
                        </div>
                        ${!isCorrect ? `
                            <div class="result-answer correct-answer">
                                ×”×ª×©×•×‘×” ×”× ×›×•× ×”: ${q.answers[q.correct]}
                            </div>
                            <div class="explanation">
                                ğŸ’¡ ${q.explanation}
                            </div>
                        ` : ''}
                    </div>
                `);
            });

            const score = studentData.score;
            document.getElementById('scoreDisplay').textContent = `${score}%`;
            
            let emoji, feedback;
            if (score >= 90) {
                emoji = 'ğŸ†';
                feedback = '××¢×•×œ×”! ××ª×” ××•××—×” ×œ×’×œ×™×©×” ×‘×˜×•×—×”!';
            } else if (score >= 70) {
                emoji = 'ğŸŒŸ';
                feedback = '×›×œ ×”×›×‘×•×“! ×™×© ×œ×š ×™×“×¢ ×˜×•×‘, ××‘×œ ×™×© ××§×•× ×œ×©×™×¤×•×¨.';
            } else if (score >= 50) {
                emoji = 'ğŸ“š';
                feedback = '×œ× ×¨×¢, ××‘×œ ×›×“××™ ×œ×œ××•×“ ×¢×•×“ ×¢×œ ××‘×˜×—×ª ××™×“×¢.';
            } else {
                emoji = 'ğŸ’ª';
                feedback = '×¦×¨×™×š ×œ×©×¤×¨! ×—×©×•×‘ ×××•×“ ×œ×œ××•×“ ×¢×œ ×’×œ×™×©×” ×‘×˜×•×—×”.';
            }

            document.getElementById('resultEmoji').textContent = emoji;
            document.getElementById('scoreFeedback').textContent = feedback;
            document.getElementById('resultsDetails').innerHTML = resultsHTML.join('');
        }

        function downloadExcel() {
            const data = [];
            
            // Create header row
            const headers = [
                '×©× ×¤×¨×˜×™',
                '×©× ××©×¤×—×”',
                '×›×™×ª×”',
                '×ª××¨×™×š',
                '×©×¢×”',
                '×¦×™×•×Ÿ',
                '×ª×©×•×‘×•×ª × ×›×•× ×•×ª',
                '×¡×”×´×› ×©××œ×•×ª'
            ];
            
            // Add question columns
            questions.forEach((q, i) => {
                headers.push(`×©××œ×” ${i + 1}`);
                headers.push(`×ª×©×•×‘×ª ×”×ª×œ××™×“ ${i + 1}`);
                headers.push(`×ª×©×•×‘×” × ×›×•× ×” ${i + 1}`);
                headers.push(`×”×× × ×›×•×Ÿ ${i + 1}`);
                headers.push(`×”×¡×‘×¨ ${i + 1}`);
            });

            data.push(headers);

            // Create data row
            const row = [
                studentData.firstName,
                studentData.lastName,
                studentData.className,
                studentData.date,
                studentData.time,
                studentData.score + '%',
                studentData.correctCount,
                studentData.totalQuestions
            ];

            questions.forEach((q, index) => {
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer === q.correct;
                
                row.push(q.question);
                row.push(q.answers[userAnswer]);
                row.push(q.answers[q.correct]);
                row.push(isCorrect ? '× ×›×•×Ÿ' : '×œ× × ×›×•×Ÿ');
                row.push(isCorrect ? '' : q.explanation);
            });

            data.push(row);

            // Create workbook and worksheet
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(data);

            // Set column widths
            ws['!cols'] = [
                { wch: 15 }, { wch: 15 }, { wch: 10 }, { wch: 12 }, { wch: 10 },
                { wch: 8 }, { wch: 12 }, { wch: 12 }
            ];
            
            questions.forEach(() => {
                ws['!cols'].push({ wch: 40 }); // Question
                ws['!cols'].push({ wch: 30 }); // User answer
                ws['!cols'].push({ wch: 30 }); // Correct answer
                ws['!cols'].push({ wch: 10 }); // Is correct
                ws['!cols'].push({ wch: 50 }); // Explanation
            });

            XLSX.utils.book_append_sheet(wb, ws, '×ª×•×¦××•×ª ××‘×—×Ÿ');

            // Generate filename
            const fileName = `××‘×—×Ÿ_×’×œ×™×©×”_×‘×˜×•×—×”_${studentData.firstName}_${studentData.lastName}_${new Date().getTime()}.xlsx`;
            
            // Save file
            XLSX.writeFile(wb, fileName);
        }
    </script>
</body>
</html>
